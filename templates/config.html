<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Configuração Local · Integração Stripe</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="/static/css/styles.css" rel="stylesheet">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-dark" role="navigation" aria-label="Menu principal">
  <div class="container">
    <a class="navbar-brand" href="/">Stripe Integration API</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarMain">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarMain">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
        <li class="nav-item"><a class="nav-link" href="/docs">Docs</a></li>
        <li class="nav-item"><a class="nav-link" href="/config">Config</a></li>
        <li class="nav-item"><a class="nav-link" href="/stores">Lojas</a></li>
      </ul>
    </div>
  </div>
</nav>
<main class="container my-4">
  <div class="alert alert-warning">Acesso restrito a localhost. Esta página exibe configuração e permite ajuste de loja sem expor segredos.</div>
  <section class="mb-4">
    <h2 class="h4">Projeto</h2>
    <div class="row">
      <div class="col-lg-6">
        <ul class="list-group">
          <li class="list-group-item d-flex justify-content-between align-items-center">DOMAIN <span class="badge text-bg-secondary">{{ cfg.DOMAIN }}</span></li>
          <li class="list-group-item d-flex justify-content-between align-items-center">API_VERSION <span class="badge text-bg-secondary">{{ cfg.API_VERSION }}</span></li>
          <li class="list-group-item d-flex justify-content-between align-items-center">DOCS_PUBLIC <span class="badge text-bg-secondary">{{ cfg.DOCS_PUBLIC }}</span></li>
          <li class="list-group-item d-flex justify-content-between align-items-center">RATE_LIMIT_DEFAULT <span class="badge text-bg-secondary">{{ cfg.RATE_LIMIT_DEFAULT }}</span></li>
          <li class="list-group-item d-flex justify-content-between align-items-center">RATE_LIMIT_LOGIN <span class="badge text-bg-secondary">{{ cfg.RATE_LIMIT_LOGIN }}</span></li>
          <li class="list-group-item d-flex justify-content-between align-items-center">RATE_LIMIT_CHECKOUT <span class="badge text-bg-secondary">{{ cfg.RATE_LIMIT_CHECKOUT }}</span></li>
          <li class="list-group-item d-flex justify-content-between align-items-center">RATE_LIMIT_WEBHOOK <span class="badge text-bg-secondary">{{ cfg.RATE_LIMIT_WEBHOOK }}</span></li>
        </ul>
      </div>
      <div class="col-lg-6">
        <ul class="list-group">
          <li class="list-group-item d-flex justify-content-between align-items-center">PLATFORM_PRICE_ID configurado <span class="badge text-bg-secondary">{{ cfg.PLATFORM_PRICE_ID }}</span></li>
          <li class="list-group-item d-flex justify-content-between align-items-center">STRIPE_WEBHOOK_SECRET configurado <span class="badge text-bg-secondary">{{ cfg.STRIPE_WEBHOOK_SECRET }}</span></li>
          <li class="list-group-item d-flex justify-content-between align-items-center">PAYMENTS_EVENTS_SECRET configurado <span class="badge text-bg-secondary">{{ cfg.PAYMENTS_EVENTS_SECRET }}</span></li>
          <li class="list-group-item d-flex justify-content-between align-items-center">PAYMENTS_EVENTS_PATH <span class="badge text-bg-secondary">{{ cfg.PAYMENTS_EVENTS_PATH }}</span></li>
          <li class="list-group-item d-flex justify-content-between align-items-center">PAYMENTS_EVENTS_HEADER <span class="badge text-bg-secondary">{{ cfg.PAYMENTS_EVENTS_HEADER }}</span></li>
        </ul>
      </div>
    </div>
  </section>
  <section class="mb-4">
    <h2 class="h4">Auditoria de Configurações</h2>
    <div class="table-responsive">
      <table class="table table-sm table-bordered align-middle">
        <thead class="table-light">
          <tr>
            <th>Grupo</th>
            <th>Chave</th>
            <th>Valor</th>
            <th>Obrigatório</th>
            <th>Status</th>
            <th>Mensagem</th>
          </tr>
        </thead>
        <tbody>
          {% for it in audit['items'] %}
          <tr>
            <td>{{ it.group }}</td>
            <td><code>{{ it.key }}</code></td>
            <td>
              {% if it.masked %}
                {% if it.value %}***{% else %}{% endif %}
              {% else %}
                {{ it.value }}
              {% endif %}
            </td>
            <td>{{ 'sim' if it.required else 'não' }}</td>
            <td>
              {% if it.ok %}
                <span class="badge text-bg-success">OK</span>
              {% else %}
                <span class="badge text-bg-danger">FALHA</span>
              {% endif %}
            </td>
            <td>{{ it.message }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    <div><a class="btn btn-outline-secondary btn-sm" href="/config/audit">Abrir como JSON</a></div>
  </section>
  <section class="mb-4">
    <h2 class="h4">Gerenciar Lojas</h2>
    <p>Use a página <a href="/stores">Lojas</a> para criar, atualizar e excluir lojas, além de editar <code>storeDomain</code> diretamente.</p>
  </section>
  <section class="mb-4">
    <h2 class="h4">Referências</h2>
    <ul>
      <li><a href="/docs">Docs Interativas</a></li>
      <li><a href="/status">Status</a></li>
      <li><a href="/debug/routes">Routes</a></li>
      <li><a href="/api/v1/account-status/acct_123">Exemplo de status</a></li>
    </ul>
  </section>
</main>
<footer class="bg-light py-3" role="contentinfo">
  <div class="container text-center">
    <small>© Stripe Integration API</small>
  </div>
</footer>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="/static/js/config.js"></script>
</body>
</html>
